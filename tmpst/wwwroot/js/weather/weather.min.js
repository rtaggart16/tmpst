function submitWeatherRequest(n){let r=$("#method-type-select").val(),t=$("#input-type-select").val(),i="",u=validateLocationInput(t);u==!0?(i=t=="latlng"?$("#latitude-input").val()+","+$("#longitude-input").val():$("#name-or-postcode-input").val(),resetWeatherPage(),contactAPI(r,i,n)):t=="latlng"?Swal.fire({type:"error",title:"Invalid Input",text:"You must specify both a latitude and a longitude"}):Swal.fire({type:"error",title:"Invalid Input",text:"You must specify a Postcode or a Place Name"})}function contactAPI(n,t,i){let r="https://api.apixu.com/v1/"+n+".json?key="+i+"&q="+t;n=="forecast"&&(r=r+"&days=7");$.ajax({type:"GET",url:r,contentType:"application/json",success:function(t){if(n=="forecast"){let n=[];currentForecastDataset=t.forecast;$.each(t.forecast.forecastday,function(t,i){let r=new Date(i.date);n.push(r)});let i=window.matchMedia("only screen and (max-width: 760px)").matches;i==!0?(updateForecastTableBodyMobile(t.forecast.forecastday),forecastCtx=document.getElementById("forecast-overall-chart").getContext("2d"),collapseExpandToggle("weather-wizard-arrow-up","weather-wizard-arrow-down","weather-wizard-container"),$("#weather-forecast-data-container-mobile").fadeIn(300)):(currentForecastDataset=t.forecast,forecastCtx=document.getElementById("forecast-overall-chart").getContext("2d"),updateForecastTableHead(n),updateForecastTableBody(t.forecast.forecastday),collapseExpandToggle("weather-wizard-arrow-up","weather-wizard-arrow-down","weather-wizard-container"),$("#weather-forecast-data-container").fadeIn(300))}else updateCurrentWeatherDataContainers(t),currentDayCtx=document.getElementById("current-day-chart").getContext("2d"),$("#current-weather-card-span").text("Current Weather for "+t.location.name),currentDayDataset=t,analyseCurrentDayData(),collapseExpandToggle("weather-wizard-arrow-up","weather-wizard-arrow-down","weather-wizard-container"),$("#weather-current-data-container").fadeIn(300)},error:function(n){n.statusText=="error"&&Swal.fire({type:"error",title:"Data Request Error",text:"We could not find any weather information for "+t+". Please try another location"})}})}function updateCurrentWeatherDataContainers(n){$("#current-weather-icon-container").append('<img src="'+n.current.condition.icon+'" />');$("#current-weather-condition-container").append("<span><strong>Condition: <\/strong>"+n.current.condition.text+"<\/span>");$("#current-weather-temp-container").append("<span><strong>Temperature: <\/strong>"+n.current.temp_c+"&#8451<\/span>");$("#current-weather-feel-temp-container").append("<span><strong>Feels Like: <\/strong>"+n.current.feelslike_c+"&#8451<\/span>");$("#current-weather-wind-dir-container").append("<span><strong>Wind Direction: <\/strong>"+n.current.wind_dir+"<\/span>");$("#current-weather-wind-speed-container").append("<span><strong>Wind Speed(mph): <\/strong>"+n.current.wind_mph+"<\/span>")}function updateForecastTableHead(n){let t=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];$("#forecast-tbl-head").append('<tr id="temp-tbl-head-row"><\/tr>');$.each(n,function(n,i){let r=t[i.getDay()];$("#temp-tbl-head-row").append("<th>"+r+"<\/th>")})}function updateForecastTableBody(n){let t=[],i=[],r=[],u=[];$.each(n,function(n,f){t.push(f.day.condition.icon);i.push(f.day.avgtemp_c);r.push(f.day.maxtemp_c);u.push(f.day.condition.text)});$("#forecast-head-only").append('<tr><td><img src="'+t[0]+'" /><\/td><td><img src="'+t[1]+'" /><\/td><td><img src="'+t[2]+'" /><\/td><td><img src="'+t[3]+'" /><\/td><td><img src="'+t[4]+'" /><\/td><td><img src="'+t[5]+'" /><\/td><td><img src="'+t[6]+'" /><\/td><\/tr>');$("#forecast-tbl-body").append('<tr><td><img src="'+t[0]+'" /><\/td><td><img src="'+t[1]+'" /><\/td><td><img src="'+t[2]+'" /><\/td><td><img src="'+t[3]+'" /><\/td><td><img src="'+t[4]+'" /><\/td><td><img src="'+t[5]+'" /><\/td><td><img src="'+t[6]+'" /><\/td><\/tr>');$("#forecast-tbl-body").append("<tr><td>"+u[0]+"<\/td><td>"+u[1]+"<\/td><td>"+u[2]+"<\/td><td>"+u[3]+"<\/td><td>"+u[4]+"<\/td><td>"+u[5]+"<\/td><td>"+u[6]+"<\/td><\/tr>");$("#forecast-tbl-body").append("<tr><td><strong>Max Temp<\/strong> - "+r[0]+"<\/td><td><strong>Max Temp<\/strong> - "+r[1]+"&#8451<\/td><td><strong>Max Temp<\/strong> - "+r[2]+"&#8451<\/td><td><strong>Max Temp<\/strong> - "+r[3]+"&#8451<\/td><td><strong>Max Temp<\/strong> - "+r[4]+"&#8451<\/td><td><strong>Max Temp<\/strong> - "+r[5]+"&#8451<\/td><td><strong>Max Temp<\/strong> - "+r[6]+"&#8451<\/td><\/tr>");$("#forecast-tbl-body").append("<tr><td><strong>Avg Temp<\/strong> - "+i[0]+"<\/td><td><strong>Avg Temp<\/strong> - "+i[1]+"&#8451<\/td><td><strong>Avg Temp<\/strong> - "+i[2]+"&#8451<\/td><td><strong>Avg Temp<\/strong> - "+i[3]+"&#8451<\/td><td><strong>Avg Temp<\/strong> - "+i[4]+"&#8451<\/td><td><strong>Avg Temp<\/strong> - "+i[5]+"&#8451<\/td><td><strong>Avg Temp<\/strong> - "+i[6]+"&#8451<\/td><\/tr>")}function updateForecastTableBodyMobile(n){let t=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];$.each(n,function(n,i){let r=new Date(i.date),u=t[r.getDay()];$("#forecast-tbl-body-mobile").append("<tr><td><strong>"+u+'<\/strong><\/td><td><img src="'+i.day.condition.icon+'" /><\/td><td><strong>Avg. Temp: <\/strong>'+i.day.avgtemp_c+"&#8451 <\/td>")})}function analyseForecastData(){let f=[],n=[],t=[],i=[],r=[],u=[];$.each(currentForecastDataset.forecastday,function(e,o){f.push(o.date);n.push(o.day.avgtemp_c);t.push(o.day.maxtemp_c);i.push(o.day.mintemp_c);r.push(o.day.avghumidity);u.push(o.day.avgvis_miles)});ForecastChart!=undefined?updateForecastChart(n,t,i,r,u):ForecastChart=new Chart(forecastCtx,{type:"bar",data:{datasets:[{label:"Average Temperature",data:n,borderColor:forecastAnalysisPallet.Avg_Temp},{label:"Max Temperature",data:t,borderColor:forecastAnalysisPallet.Max_Temp,type:"line"},{label:"Min Temperature",data:i,borderColor:forecastAnalysisPallet.Min_Temp,type:"line"},{label:"Humidity",data:r,borderColor:forecastAnalysisPallet.Humidity,type:"line"},{label:"Visibility",data:u,borderColor:forecastAnalysisPallet.Visibility,type:"line"}],labels:f},options:{maintainAspectRatio:!1,responsive:!0}});collapseExpandToggle("forecast-result-arrow-up","forecast-result-arrow-down","main-forecast-result-container");collapseExpandToggle("forecast-mobile-result-arrow-up","forecast-mobile-result-arrow-down","forecast-mobile-table-and-submit");$("#forecast-weather-analysis-landing").fadeIn(300).promise().done(function(){$("#current-weather-analysis-landing").fadeOut(300).promise().done(function(){$("#weather-analysis-landing").fadeIn(300)})})}function analyseCurrentDayData(){let n=[currentDayDataset.current.temp_c,currentDayDataset.current.feelslike_c,currentDayDataset.current.humidity,currentDayDataset.current.wind_mph],t=[currentDayAnalysisPallet.Current_Temp,currentDayAnalysisPallet.Feels_Like,currentDayAnalysisPallet.Humidity,currentDayAnalysisPallet.Wind_Speed],i={label:"Current Weather Conditions in "+currentDayDataset.location.name+" ("+currentDayDataset.location.country+")",data:n,borderColor:t,backgroundColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)"],borderColor:["rgb(255, 99, 132)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)"]};currentDayChart!=undefined?updateCurrentDayChart(n):currentDayChart=new Chart(currentDayCtx,{type:"horizontalBar",data:{labels:["Current Temp","Feels Like","Humidity","Wind (mph)"],datasets:[i]},options:{legend:{display:!0},ticks:{beginAtZero:!0},maintainAspectRatio:!1}})}function updateCurrentDayChart(n){currentDayChart.data.datasets[0].data=n;currentDayChart.data.datasets[0].label="Current Weather Conditions in "+currentDayDataset.location.name+" ("+currentDayDataset.location.country+")";currentDayChart.update()}function updateForecastChart(n,t,i,r,u){let f=[n,t,i,r,u];for(let n=0;n<=4;n++)ForecastChart.data.datasets[n].data=f[n];ForecastChart.update()}function validateLocationInput(n){if(n=="latlng"){let n=$("#latitude-input").val(),t=$("#longitude-input").val();return n!=" "&&n!=""&&t!=" "&&t!=""?!0:!1}let n=$("#name-or-postcode-input").val();return n!=""&&n!=" "?!0:!1}let currentForecastDataset={},currentDayDataset={},ForecastChart,currentDayChart,forecastCtx,currentDayCtx;$("#input-type-select").on("change",function(){let n=$("#input-type-select").val();n=="latlng"?$("#name-and-postcode-input-container").fadeOut(300).promise().done(function(){$("#lat-long-input-container").fadeIn(300)}):$("#lat-long-input-container").fadeOut(300).promise().done(function(){$("#name-and-postcode-input-container").fadeIn(300)})});$("#name-or-postcode-input").on("keypress",function(n){n.which==13&&$("#submit-weather-request-btn").click()});$("#longitude-input").on("keypress",function(n){n.which==13&&$("#submit-weather-request-btn").click()});$("#latitude-input").on("keypress",function(n){n.which==13&&($("#longitude-input").val()!=""&&$("#longitude-input").val()!=" "?$("#submit-weather-request-btn").click():Swal.fire({type:"error",title:"Invalid Request",text:"You must specify both a latitude and a longitude"}))});